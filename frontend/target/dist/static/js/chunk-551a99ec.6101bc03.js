(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-551a99ec"],{"413a":function(e,t,n){"use strict";(function(e){n("d3b7"),n("25f0");var a=n("1146"),i=n.n(a);t["a"]={data:function(){return{file:null,nn:[],change:!1,model:null,excel:null,tahun:[],tahunKirim:null,options:[]}},methods:{kirim:function(){var e=this;null!==this.tahunKirim&&null!==this.excel?(this.$q.loading.show(),this.$http.post("/api/kirimlaporankoperasi",this.useFormData(),{headers:this.$auth.getHeader()}).then((function(t){var n=t.data;400===n.errCode?e.$q.notify({type:"negative",message:n.err}):e.$q.notify({type:"positive",message:"Pengajuan Laporan Berhasil dilakukan"}),e.$q.loading.hide()})).catch((function(){e.$q.notify({type:"negative",message:"Terjadi kesalahan refresh (F5)"}),e.$q.loading.hide()}))):this.$q.notify({type:"negative",message:"Isi Semua Field"})},useFormData:function(){var e=new FormData;return e.append("files",this.excel),e.append("tahun",this.tahunKirim),e},changeFile:function(t){var n=this;if(this.excel=t,"application/vnd.ms-excel"!==t.type)return this.$q.notify({type:"negative",message:"File Harus dengan Format xls / xlsx"}),void(this.model=null);var a=new FileReader;a.readAsArrayBuffer(t),a.onload=function(t){var a=e.from(t.target.result).toString("base64"),s=i.a.read(a,{type:"base64"});n.nn=[];for(var o=0;o<s.SheetNames.length;o++){var r=s.Sheets[s.SheetNames[o]];n.nn.push(i.a.utils.sheet_to_html(r,{}))}n.change=!0}},getData:function(){var e=this;this.$http.get("/api/getonefile",{headers:this.$auth.getHeader()}).then((function(t){var n=t.data,a=i.a.read(n.file,{type:"base64"});e.nn=[];for(var s=0;s<a.SheetNames.length;s++){var o=a.Sheets[a.SheetNames[s]];e.nn.push(i.a.utils.sheet_to_html(o,{}))}})).catch((function(){}))},getOptions:function(){var e=new Date,t=e.getFullYear()-10,n=t;this.options=[];while(n<t+20)this.options.push(n),n++}},created:function(){this.getOptions()}}}).call(this,n("b639").Buffer)},"7e07":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-md"},[n("div",{staticClass:"row"},[n("q-card",{staticClass:"full-width"},[n("q-card-section",[n("div",{staticClass:"text-h6"},[e._v("Kirim Laporan Tahunan")])]),n("q-separator"),n("q-card-section",[n("q-file",{attrs:{filled:"","bottom-slots":"",type:"file",label:"Pilih File Excel",counter:""},on:{input:e.changeFile},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"cloud_upload"},on:{click:function(e){e.stopPropagation()}}})]},proxy:!0},{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"close"},on:{click:function(t){t.stopPropagation(),e.model=null}}})]},proxy:!0},{key:"hint",fn:function(){return[e._v(" File Excel ")]},proxy:!0}]),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}),n("br"),n("q-select",{attrs:{outlined:"",options:e.options,dense:!0,label:"Tahun","options-dense":!1},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.tahunKirim,callback:function(t){e.tahunKirim=t},expression:"tahunKirim"}}),n("br"),n("q-btn",{attrs:{color:"primary","icon-right":"send",label:"Kirim Laporan"},on:{click:e.kirim}})],1)],1)],1),n("br"),e.change?n("div",{staticClass:"row"},[n("q-card",[n("q-card-section",e._l(e.nn,(function(t){return n("div",{key:t},[n("div",{domProps:{innerHTML:e._s(t)}})])})),0)],1)],1):e._e()])},i=[],s=n("413a"),o=s["a"],r=(n("c586"),n("2877")),l=Object(r["a"])(o,a,i,!1,null,null,null);t["default"]=l.exports},c586:function(e,t,n){"use strict";var a=n("ea99"),i=n.n(a);i.a},ea99:function(e,t,n){}}]);
//# sourceMappingURL=chunk-551a99ec.6101bc03.js.map